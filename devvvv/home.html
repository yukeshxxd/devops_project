<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sweet Treats</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Playfair+Display:wght@700&family=Poppins:wght@300;400;600;700&display=swap"
    rel="stylesheet"
  />
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ["Poppins", "sans-serif"],
            display: ["Playfair Display", "serif"],
            serif: ["Merriweather", "serif"], 
          },
          colors: {
            chocolateDark: '#3A201A', 
            chocolateLight: '#6F4E37', 
            creamyWhite: '#FFF8E1', 
            berryRed: '#A30000', 
            goldenCaramel: '#D4AF37', 
          },
          boxShadow: {
            'deep': '0 15px 30px rgba(0, 0, 0, 0.25)',
            'subtle': '0 4px 10px rgba(0, 0, 0, 0.08)',
          }
        },
      },
    };
  </script>
  <style>
    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }
    ::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #555;
    }
    .product-card {
      transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out, background-color 0.3s ease-in-out;
    }
    .product-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
      background-color: #fcfcfc;
    }
    .category-button.active {
      background-color: #A30000;
      color: white;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    .hero-overlay {
      background: linear-gradient(to bottom, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0.6) 100%);
    }
  </style>
</head>
<body class="bg-creamyWhite text-chocolateDark font-sans relative">

  <header class="sticky top-0 z-50 bg-chocolateDark text-creamyWhite shadow-deep">
    <div class="container mx-auto flex justify-between items-center py-4 px-6">
      <div class="flex items-center space-x-3">
        <img
          src="https://cdn-icons-png.flaticon.com/512/3075/3075977.png"
          alt="Chocolate Logo"
          class="w-10 h-10 transform rotate-[-5deg]"
        />
        <h1 class="text-3xl font-bold font-display tracking-wide">Sweet Treats</h1>
      </div>
      <nav class="space-x-8 text-lg font-semibold hidden md:flex">
        <a href="home.html" class="hover:text-goldenCaramel transition duration-300 transform hover:scale-105">Home</a>
        <a href="about.html" class="hover:text-goldenCaramel transition duration-300 transform hover:scale-105">About</a>
        <a href="contactus.html" class="hover:text-goldenCaramel transition duration-300 transform hover:scale-105">Contact</a>
        <a href="login.html" id="loginLogoutLink" class="hover:text-goldenCaramel transition duration-300 transform hover:scale-105">Login</a>
      </nav>
      <button class="md:hidden text-creamyWhite text-3xl">
        &#9776; </button>
    </div>
  </header>

  <section
    class="bg-cover bg-center h-[650px] flex items-center justify-center relative"
    style="
      background-image: url('https://images.unsplash.com/photo-1612531861503-68f0cc3ba04b?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D');
    "
  >
    <div class="absolute inset-0 hero-overlay"></div>
    <div class="text-center text-white space-y-7 px-8 z-10">
      <h2 class="text-6xl md:text-8xl font-bold font-display leading-tight drop-shadow-lg animate-fade-in-down">
        Indulge in Exquisite Chocolates
      </h2>
      <p class="text-xl md:text-2xl font-light tracking-wide animate-fade-in-up">
        Handcrafted with passion, delivered with joy to your doorstep.
      </p>
      <a
        href="#products"
        class="inline-block bg-goldenCaramel text-chocolateDark px-10 py-5 rounded-full text-xl font-semibold shadow-xl hover:bg-creamyWhite hover:text-chocolateDark transition transform hover:scale-105 duration-300 animate-bounce-in"
        >Discover Our Collection</a
      >
    </div>
  </section>

  <section class="container mx-auto py-16 px-6">
    <div
      class="flex flex-col md:flex-row justify-between items-center mb-10 gap-8"
    >
      <input
        id="searchInput"
        type="text"
        placeholder="Search for your favorite chocolate..."
        class="w-full md:w-1/3 px-6 py-4 border border-gray-300 rounded-lg shadow-subtle focus:outline-none focus:ring-2 focus:ring-chocolateLight focus:border-chocolateLight text-chocolateDark placeholder-gray-500 text-lg"
      />
      <div id="categoryButtons" class="space-x-4 flex flex-wrap justify-center gap-y-3">
        <button
          data-category="all"
          class="category-button px-6 py-3 bg-berryRed text-white rounded-full font-semibold shadow-md hover:bg-chocolateDark transition duration-300 active"
        >
          All Varieties
        </button>
        <button
          data-category="dark"
          class="category-button px-6 py-3 bg-gray-200 text-chocolateDark rounded-full font-semibold shadow-md hover:bg-gray-300 transition duration-300"
        >
          Dark Chocolates
        </button>
        <button
          data-category="milk"
          class="category-button px-6 py-3 bg-gray-200 text-chocolateDark rounded-full font-semibold shadow-md hover:bg-gray-300 transition duration-300"
        >
          Milk Chocolates
        </button>
        <button
          data-category="truffles"
          class="category-button px-6 py-3 bg-gray-200 text-chocolateDark rounded-full font-semibold shadow-md hover:bg-gray-300 transition duration-300"
        >
          Artisan Truffles
        </button>
      </div>
    </div>
  </section>

  <section
    id="products"
    class="container mx-auto px-6 py-16 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-12"
  >
    </section>

  <section class="bg-chocolateDark py-20 text-creamyWhite text-center">
    <h3 class="text-4xl font-bold font-display mb-6">
      Unlock Sweet Deals and Updates!
    </h3>
    <p class="mb-8 text-xl max-w-2xl mx-auto">
      Join our exclusive newsletter to receive irresistible offers, tantalizing new product alerts, and delightful chocolate tips directly in your inbox.
    </p>
    <form class="flex justify-center gap-4 max-w-lg mx-auto px-6" onsubmit="event.preventDefault(); alert('Thank you for subscribing to our delightful newsletter!');">
      <input
        type="email"
        placeholder="Enter your email address"
        class="px-6 py-3 rounded-lg w-2/3 text-chocolateDark placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-goldenCaramel"
        required
      />
      <button
        class="bg-goldenCaramel text-chocolateDark px-6 py-3 rounded-lg font-semibold shadow-md hover:bg-creamyWhite hover:text-chocolateDark transition duration-300 transform hover:scale-105"
        type="submit"
      >
        Subscribe Now
      </button>
    </form>
  </section>

  <footer class="bg-gray-100 py-10 text-center text-gray-600">
    <p class="text-lg">&copy; 2025 The Chocolate Shop. All rights reserved.</p>
    <div class="flex justify-center space-x-6 mt-5">
      <a href="#" class="hover:text-chocolateDark transition duration-300 text-lg">Privacy Policy</a>
      <a href="#" class="hover:text-chocolateDark transition duration-300 text-lg">Terms of Service</a>
    </div>
  </footer>

  <aside
    id="cartSidebar"
    class="fixed top-0 right-0 h-full w-96 bg-creamyWhite shadow-2xl p-6 overflow-y-auto transform translate-x-full transition-transform duration-300 ease-in-out z-50 flex flex-col"
  >
    <div class="flex justify-between items-center mb-8 pb-4 border-b border-gray-200">
      <h2 class="text-3xl font-bold text-berryRed font-display">Your Sweet Cart</h2>
      <button
        id="closeCartBtn"
        class="text-chocolateDark text-4xl leading-none hover:text-berryRed transition duration-300"
      >
        &times;
      </button>
    </div>
    <ul id="cartItems" class="space-y-6 flex-grow overflow-auto border-b border-gray-200 py-6"></ul>
    <div class="mt-8 font-semibold text-2xl text-right text-chocolateDark" id="cartTotal">Total: Rs.0</div>
    <button
      id="proceedCheckoutBtn"
      class="mt-6 w-full bg-goldenCaramel text-chocolateDark py-4 rounded-full text-xl font-semibold shadow-lg hover:bg-berryRed hover:text-creamyWhite transition duration-300 transform hover:scale-105"
      title="Proceed to Checkout"
    >
      Proceed to Checkout
    </button>
  </aside>

  <button
    id="cartToggleBtn"
    class="fixed bottom-8 right-8 bg-berryRed text-creamyWhite px-7 py-4 rounded-full shadow-xl hover:bg-chocolateDark transition duration-300 transform hover:scale-105 z-50 text-2xl font-semibold flex items-center space-x-3"
    title="Toggle Cart"
  >
    <span>ðŸ›’</span> <span>Cart (<span id="cartCount">0</span>)</span>
  </button>

  <script>
    const products = [
      {
        id: 1,
        name: "Dark Chocolate Supreme",
        category: "dark",
        price: 799,
        rating: 4,
        image: "https://t3.ftcdn.net/jpg/02/42/11/72/360_F_242117284_FyhQaHVNf76gqsNHNM54I0kTRxcC2Dl8.jpg",
      },
      {
        id: 2,
        name: "Belgium Truffle Delights",
        category: "truffles",
        price: 1200,
        rating: 5,
        image: "https://static.wixstatic.com/media/8c0f2e_89eead42358d4227b22d27038f20ecf8~mv2.jpg/v1/fill/w_603,h_1080,al_c,q_85,enc_avif,quality_auto/8c0f2e_89eead42358d4227b22d27038f20ecf8~mv2.jpg",
      },
      {
        id: 3,
        name: "Silky Kisses Milk Chocolate",
        category: "milk",
        price: 1550,
        rating: 3,
        image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRwxvcU_1mYf1Mm-yVF83rKpVfq1TTPjL4WrQ&s",
      },
      {
        id: 4,
        name: "Classic Milk Chocolate Bar",
        category: "milk",
        price: 699,
        rating: 4,
        image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSAqQXqZLQLbAIkVxTyKPxCOYfsWv-w-Zj3vA&s",
      },
      {
        id: 5,
        name: "Hazelnut Dark Dream",
        category: "dark",
        price: 950,
        rating: 5,
        image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQtSWH1hPlcwQA79nhmpLIr6zvvl9sHY53AwQ&s",
      },
      {
        id: 6,
        name: "Elegant White Truffles",
        category: "truffles",
        price: 1300,
        rating: 4,
        image: "https://www.sugarhero.com/wp-content/uploads/2020/12/champagne-white-chocolate-truffles-FEATURED-IMAGE.jpg",
      },
      {
        id: 7,
        name: "Salted Caramel Milk Delight",
        category: "milk",
        price: 850,
        rating: 4,
        image: "https://static.wixstatic.com/media/10d1e0_7630cfce012340869fde4b6202f9ba87~mv2.jpg/v1/fit/w_500,h_500,q_90/file.jpg",
      },
      {
        id: 8,
        name: "Refreshing Mint Dark Bar",
        category: "dark",
        price: 880,
        rating: 3,
        image: "https://m.media-amazon.com/images/I/81FGdTjXmbL._AC_UF1000,1000_QL80_.jpg",
      },
      {
        id: 9,
        name: "Assorted Truffle Gift Box",
        category: "truffles",
        price: 2100,
        rating: 5,
        image: "https://m.media-amazon.com/images/I/718bCHZSuXL.jpg",
      },
    ];
  
    // Elements
    const productContainer = document.getElementById("products");
    const searchInput = document.getElementById("searchInput");
    const categoryButtons = document.getElementById("categoryButtons");
    const cartToggleBtn = document.getElementById("cartToggleBtn");
    const cartSidebar = document.getElementById("cartSidebar");
    const closeCartBtn = document.getElementById("closeCartBtn");
    const cartItemsList = document.getElementById("cartItems");
    const cartCount = document.getElementById("cartCount");
    const cartTotal = document.getElementById("cartTotal");
    const loginLogoutLink = document.getElementById("loginLogoutLink");
    const proceedCheckoutBtn = document.getElementById("proceedCheckoutBtn");
  
    // --- Frontend-only Cart Management ---
    let cart = JSON.parse(localStorage.getItem('chocolateCart')) || []; // Load cart from local storage
    // --- END Frontend-only Cart Management ---
  
    // Function to get current login status from localStorage
    function getLoginStatus() {
      return localStorage.getItem('isLoggedIn') === 'true';
    }

    // Update login/logout link in header
    function updateLoginLogoutLink() {
      if (getLoginStatus()) { // Check current status
        loginLogoutLink.textContent = "Logout";
        loginLogoutLink.href = "#"; // Prevent navigation
        loginLogoutLink.onclick = (e) => {
          e.preventDefault();
          localStorage.removeItem('isLoggedIn'); // Simulate logout
          alert("Logged out successfully");
          updateLoginLogoutLink(); // Update link immediately
          cart = []; // Clear cart on logout
          localStorage.removeItem('chocolateCart'); // Clear cart from local storage
          renderCart();
          window.location.href = "/login.html"; // Redirect to login page
        };
      } else {
        loginLogoutLink.textContent = "Login";
        loginLogoutLink.href = "/login.html";
        loginLogoutLink.onclick = null; // Remove handler if not logged in
      }
    }
  
    // Render star ratings helper
    function renderStars(rating) {
      let stars = "";
      for (let i = 0; i < 5; i++) {
        stars += `<span class="text-goldenCaramel">${i < rating ? "&#9733;" : "&#9734;"}</span>`;
      }
      return stars;
    }
  
    // Render products with filtering
    function renderProducts(filterCategory = "all", searchTerm = "") {
      productContainer.innerHTML = "";
      const filtered = products.filter((p) => {
        const matchesCategory =
          filterCategory === "all" || p.category === filterCategory;
        const matchesSearch =
          p.name.toLowerCase().includes(searchTerm.toLowerCase());
        return matchesCategory && matchesSearch;
      });
  
      if (filtered.length === 0) {
        productContainer.innerHTML = '<p class="col-span-full text-center text-xl text-gray-600 py-10">No chocolates found matching your criteria. Try a different search or category!</p>';
        return;
      }

      filtered.forEach((product) => {
        const div = document.createElement("div");
        div.className =
          "product-card bg-white rounded-lg shadow-subtle p-6 flex flex-col items-center border border-gray-100";
  
        div.innerHTML = `
          <img
            src="${product.image}"
            alt="${product.name}"
            class="h-56 w-full object-cover rounded-lg mb-5 transform transition duration-300 hover:scale-105"
          />
          <h3 class="font-bold text-xl text-chocolateDark font-display mb-2 text-center">${product.name}</h3>
          <div class="text-lg mb-3">${renderStars(product.rating)}</div>
          <p class="text-berryRed font-bold text-2xl mb-5">Rs.${product.price}</p>
          <button
            class="mt-auto w-full bg-chocolateLight text-creamyWhite px-6 py-3 rounded-full text-lg font-semibold hover:bg-berryRed transition duration-300 addToCartBtn"
            data-id="${product.id}"
          >
            Add to Cart
          </button>
        `;
  
        productContainer.appendChild(div);
      });
  
      // Bind Add to Cart buttons
      document.querySelectorAll(".addToCartBtn").forEach((btn) =>
        btn.addEventListener("click", () => {
          if (!getLoginStatus()) { // Check getLoginStatus() directly here
            alert("Please login to add items to your cart.");
            window.location.href = "/login.html"; // Redirect to login page
            return;
          }
          const productId = parseInt(btn.getAttribute("data-id"));
          addToCart(productId);
        })
      );
    }
  
    // Add to cart (Frontend-only)
    function addToCart(productId) {
      const product = products.find((p) => p.id === productId);
      if (product) {
        const existingItem = cart.find((item) => item.id === productId);
        if (existingItem) {
          existingItem.quantity++;
        } else {
          cart.push({ ...product, quantity: 1 });
        }
        localStorage.setItem('chocolateCart', JSON.stringify(cart)); // Save to local storage
        renderCart();
        alert(`'${product.name}' added to cart!`);
      }
    }
  
    // Remove from cart (Frontend-only)
    function removeFromCart(productId) {
      cart = cart.filter((item) => item.id !== productId);
      localStorage.setItem('chocolateCart', JSON.stringify(cart)); // Save to local storage
      renderCart();
    }
  
    // Change quantity in cart (Frontend-only)
    function changeQuantity(productId, amount) {
      const item = cart.find((item) => item.id === productId);
      if (item) {
        item.quantity += amount;
        if (item.quantity <= 0) {
          removeFromCart(productId); // Remove if quantity drops to 0 or less
        }
      }
      localStorage.setItem('chocolateCart', JSON.stringify(cart)); // Save to local storage
      renderCart();
    }
  
    // Load cart from local storage (Frontend-only)
    function loadCart() {
      // Cart is already loaded at the top from localStorage
      // This function exists for consistency with original structure
    }
  
    // Render cart items in sidebar
    function renderCart() {
      cartItemsList.innerHTML = "";
      if (cart.length === 0) {
        cartItemsList.innerHTML = "<p class='text-center text-gray-500 mt-4'>Your cart is empty. Add some sweet treats!</p>";
      } else {
        cart.forEach((item) => {
          const li = document.createElement("li");
          li.className = "flex items-center space-x-4 p-3 bg-white rounded-lg shadow-sm border border-gray-100";
  
          li.innerHTML = `
            <img src="${item.image}" alt="${item.name}" class="w-20 h-20 object-cover rounded-md flex-shrink-0" />
            <div class="flex-grow">
              <h4 class="font-bold text-lg text-chocolateDark">${item.name}</h4>
              <p class="text-md text-chocolateLight">Rs.${item.price} x ${item.quantity}</p>
              <div class="flex items-center space-x-2 mt-2">
                <button class="px-3 py-1 bg-chocolateLight text-creamyWhite rounded-full hover:bg-berryRed transition" data-action="decrease" data-id="${item.id}">-</button>
                <span class="text-chocolateDark font-semibold text-lg">${item.quantity}</span>
                <button class="px-3 py-1 bg-chocolateLight text-creamyWhite rounded-full hover:bg-berryRed transition" data-action="increase" data-id="${item.id}">+</button>
                <button class="px-3 py-1 bg-red-500 text-white rounded-full ml-auto hover:bg-red-700 transition" data-action="remove" data-id="${item.id}">Remove</button>
              </div>
            </div>
          `;
  
          cartItemsList.appendChild(li);
        });
  
        // Bind buttons
        cartItemsList.querySelectorAll("button").forEach((btn) => {
          const id = parseInt(btn.getAttribute("data-id"));
          const action = btn.getAttribute("data-action");
          btn.onclick = () => {
            if (action === "increase") changeQuantity(id, 1);
            else if (action === "decrease") changeQuantity(id, -1);
            else if (action === "remove") removeFromCart(id);
          };
        });
      }
  
      const total = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
      cartTotal.textContent = `Total: Rs.${total}`;
      cartCount.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
    }
  
    // Event listeners
    cartToggleBtn.addEventListener("click", () => {
      cartSidebar.classList.toggle("translate-x-full");
      cartSidebar.classList.toggle("translate-x-0");
    });
  
    closeCartBtn.addEventListener("click", () => {
      cartSidebar.classList.add("translate-x-full");
      cartSidebar.classList.remove("translate-x-0");
    });
  
    // Search input
    let currentCategory = "all"; // Initialize currentCategory here
    searchInput.addEventListener("input", (e) => {
      renderProducts(
        currentCategory,
        e.target.value.trim()
      );
    });
  
    // Category buttons (event delegation)
    categoryButtons.addEventListener("click", (e) => {
      if (e.target.tagName === "BUTTON") {
        currentCategory = e.target.getAttribute("data-category");
        renderProducts(currentCategory, searchInput.value.trim());
  
        // Highlight active button
        [...categoryButtons.children].forEach((btn) => {
          btn.classList.remove("active", "bg-berryRed", "text-white");
          btn.classList.add("bg-gray-200", "text-chocolateDark");
        });
        e.target.classList.add("active", "bg-berryRed", "text-white");
        e.target.classList.remove("bg-gray-200", "text-chocolateDark");
      }
    });
  
    // Checkout button
    proceedCheckoutBtn.addEventListener("click", () => {
      if (!getLoginStatus()) { // Check getLoginStatus() directly here
        alert("Please login to proceed to checkout.");
        window.location.href = "/login.html";
        return;
      }
      if (cart.length === 0) {
        alert("Your cart is empty. Add some chocolates before checking out!");
        return;
      }
      alert("Proceeding to checkout with current cart items!");
    });
  
    // Initialize
    (async () => {
      updateLoginLogoutLink(); // Call this directly to ensure it reflects current localStorage state
      loadCart(); // Load cart from local storage
      renderProducts(); // Render initial products
      renderCart(); // Render initial cart
    })();
  </script>
  
</body>
</html>
